
<div style="width: 40%; margin-left: 30%">
  <nz-input-group nzSearch nzSize="large" [nzAddOnAfter]="suffixButton">
    <input type="text" nz-input placeholder="input search text"  [(ngModel)]="searchtext" (ngModelChange)="searchText()" />
  </nz-input-group>
  <ng-template #suffixButton>
    <button nz-button nzType="primary" nzSize="large" nzSearch (click)="searchText()">Search</button>
  </ng-template>
</div>
<div style="margin-right: 20px; width: 100px; margin-top: 20px">
  <button nz-button nzType="default" nzSize="default" (click)="showModal2()">&nbsp;Add&nbsp;</button>
</div>
<nz-table #basicTable [nzData]="showSecurities">
  <thead>
  <tr>
    <th>Name</th>
    <th>Type</th>
    <th>TodayPrice</th>
    <!--<th>Update Date</th>-->
    <th>Operation</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let data of basicTable.data">
    <td>
      {{ data.securityName }}
    </td>
    <td>
      {{ data.securityType }}
    </td>
    <td>
      <ng-container *ngIf="!editCache[data.securityId].edit; else passwordInputTpl">
        {{ data.todayPrice }}
      </ng-container>
      <ng-template #passwordInputTpl>
        <input type="number" nz-input [(ngModel)]="editCache[data.securityId].data.todayPrice" />
      </ng-template>
    </td>

    <!--<td>
      {{ (data.today !== null? data.today: data.lastDay) | date }}
    </td>-->

    <td>
      <ng-container *ngIf="!editCache[data.securityId].edit; else saveTpl">
        <a (click)="startEdit(data.securityId)">Edit</a>
      </ng-container>
      <ng-template #saveTpl>
        <a (click)="saveEdit(data.securityId)">Save</a>&nbsp;
        <a nz-popconfirm nzTitle="Sure to cancel?" (nzOnConfirm)="cancelEdit(data.securityId)">Cancel</a>
      </ng-template>
      <nz-divider nzType="vertical"></nz-divider>
      <a (click)="deletesecurity(data.securityId)">Delete</a>
    </td>
  </tr>
  </tbody>
</nz-table>
<nz-modal [(nzVisible)]="isVisible" nzTitle="Add Security" (nzOnCancel)="handleCancel()">
  <div>
    <form nz-form [formGroup]="validateForm">
      <nz-form-item>
      <nz-form-label [nzSpan]="7" nzRequired>Security Name</nz-form-label>
      <nz-form-control [nzSpan]="12" nzHasFeedback nzValidatingTip="Validating..." [nzErrorTip]="userErrorTpl">
        <input nz-input formControlName="securityName" [(ngModel)]="addSecurity.securityName" placeholder="username" />
        <ng-template #userErrorTpl let-control>
          <ng-container *ngIf="control.hasError('required')">
            Please input your security name!
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzRequired>Security Type</nz-form-label>
        <nz-form-control [nzSpan]="12">
          <nz-select [ngModel]="'equity'" nz-input formControlName="type" [(ngModel)]="addSecurity.securityType" >
            <nz-option [nzLabel]="'equity'" [nzValue]="'equity'"></nz-option>
            <nz-option [nzLabel]="'fx'" [nzValue]="'fx'"></nz-option>
            <nz-option [nzLabel]="'future'" [nzValue]="'future'"></nz-option>
            <nz-option [nzLabel]="'index'" [nzValue]="'index'"></nz-option>
            <nz-option [nzLabel]="'commodity'" [nzValue]="'commodity'"></nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>

    </form>
  </div>
  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
    <button nz-button nzType="primary" (click)="handleOk()" [nzLoading]="isConfirmLoading">Submit</button>
  </div>
</nz-modal>
